<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>選手記録管理</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- 記録入力 -->
    <section id="record-entry">
        <h2>選手を選んで記録を入力</h2>
        <label for="athlete-select">選手を選択：</label>
        <select id="athlete-select">
            <!-- 事前登録選手をここに追加 -->
        </select>

        <label for="event-select">種目を選択：</label>
        <select id="event-select">
            <option value="running">ダッシュ</option>
            <option value="load_running">負荷走</option>
            <option value="acceleration_running">加速走</option>
            <option value="hurdles">ハードル</option>
            <option value="long_jump">走幅跳</option>
            <option value="high_jump">走高跳</option>
            <option value="triple_jump">三段跳</option>
            <option value="javelin_throw">やり投げ</option>
            <option value="discus_throw">円盤投</option>
        </select>

        <label for="distance-select">距離を選択：</label>
        <select id="distance-select">
            <option value="30">30m</option>
            <option value="50">50m</option>
            <option value="70">70m</option>
            <option value="100">100m</option>
            <option value="120">120m</option>
            <option value="150">150m</option>
            <option value="200">200m</option>
            <option value="250">250m</option>
            <option value="300">300m</option>
            <option value="400">400m</option>
            <option value="manual">手動</option>
        </select>

        <label for="record-count">本数を選択：</label>
        <select id="record-count">
            <option value="1">1回</option>
            <option value="2">2回</option>
            <option value="3">3回</option>
            <option value="4">4回</option>
            <option value="5">5回</option>
        </select>

        <button id="add-selected-athletes">選手を追加</button>
    </section>

    <!-- 記録表 -->
    <section id="record-table">
        <h2>記録</h2>
        <table>
            <thead>
                <tr>
                    <th>選手名</th>
                    <th>種目</th>
                    <th>距離</th>
                    <th>タイム・記録</th>
                    <th>本数</th>
                    <th>削除</th>
                </tr>
            </thead>
            <tbody id="record-table-body">
                <!-- 選手ごとの記録行を動的に追加 -->
            </tbody>
        </table>
    </section>

    <!-- 新規選手登録 -->
    <section id="new-athlete-registration">
        <h2>新規選手登録</h2>
        <label for="new-athlete-name">選手名：</label>
        <input type="text" id="new-athlete-name" placeholder="新しい選手の名前">
        <button onclick="addNewAthlete()">登録</button>
    </section>

    <script>
        // 記録データを格納するための配列
        let records = [];

        // 事前登録の選手名
        const predefinedAthletes = [
            '木村美海', '相方紫帆', '岩見琉音', '前田莉佐', 
            '湯本真未', '崎本七海', '佐藤安里紗', '永瀬裕大', 
            '和田卓英', '北川大喜', '木下裕翔', '中村香葉'
        ];

        // 事前登録選手をrecords配列に追加
        predefinedAthletes.forEach(name => {
            records.push({
                playerId: records.length + 1,
                name: name,
                event: '',
                distance: '',
                records: [],
                count: 1
            });
        });

        // 事前登録選手を選手選択ドロップダウンに追加
        const athleteSelect = document.getElementById('athlete-select');
        predefinedAthletes.forEach((name, index) => {
            const option = document.createElement('option');
            option.value = index + 1;  // 1から始めるID
            option.textContent = name;
            athleteSelect.appendChild(option);
        });

        // 新しい選手をrecords配列に追加する関数
        function addNewAthlete() {
            const newAthleteName = document.getElementById('new-athlete-name').value.trim();

            // 名前が空の場合は追加しない
            if (!newAthleteName) {
                alert('選手名を入力してください。');
                return;
            }

            // 新しい選手を追加
            records.push({
                playerId: records.length + 1,
                name: newAthleteName,
                event: '',
                distance: '',
                records: [],
                count: 1
            });

            // 選手選択のドロップダウンにも新しい選手を追加
            const option = document.createElement('option');
            option.value = records.length;  // 新しい選手のID
            option.textContent = newAthleteName;
            athleteSelect.appendChild(option);

            // 選手名入力フォームをリセット
            document.getElementById('new-athlete-name').value = '';
        }

        // 選手を追加する関数
        document.getElementById('add-selected-athletes').addEventListener('click', function() {
            const selectedAthleteId = parseInt(document.getElementById('athlete-select').value);
            const event = document.getElementById('event-select').value;
            const distance = document.getElementById('distance-select').value;
            const recordCount = parseInt(document.getElementById('record-count').value);

            // 選手が選ばれていない場合は警告を表示
            if (!selectedAthleteId) {
                alert('選手を選択してください。');
                return;
            }

            // 選択した選手のIDに基づいて記録を追加
            const athlete = records[selectedAthleteId - 1];
            athlete.event = event;
            athlete.distance = distance;
            athlete.count = recordCount;
            athlete.records = new Array(recordCount).fill('');

            renderTable();
        });

        // 記録テーブルを再描画する関数
        function renderTable() {
            const tbody = document.getElementById('record-table-body');
            tbody.innerHTML = ''; // 既存のテーブル行をクリア

            records.forEach((record, index) => {
                // 記録が設定されていない選手はスキップ
                if (record.event === '' || record.distance === '') {
                    return;
                }

                const tr = document.createElement('tr');

                // 選手名
                tr.innerHTML += `<td>${record.name}</td>`;

                // 種目
                tr.innerHTML += `<td>${record.event}</td>`;

                // 距離
                tr.innerHTML += `<td>${record.distance}</td>`;

                // 記録入力（本数に応じた入力フィールド）
                let recordInputs = '';
                for (let i = 0; i < record.count; i++) {
                    recordInputs += `<input type="text" value="${record.records[i] || ''}" onchange="updateRecordField(${index}, 'records', this.value, ${i})" 
placeholder="タイム・記録 ${i+1}">`;
                }
                tr.innerHTML += `<td>${recordInputs}</td>`;

                // 本数入力
                tr.innerHTML += `<td><input type="number" value="${record.count}" onchange="updateRecordField(${index}, 'count', this.value)"></td>`;

                // 削除ボタン
                tr.innerHTML += `<td><button onclick="deleteRecord(${index})">削除</button></td>`;

                tbody.appendChild(tr);
            });
        }

        // 記録フィールドを更新する関数
        function updateRecordField(playerIndex, field, value, index) {
            if (field === 'records') {
                records[playerIndex].records[index] = value;
            } else {
                records[playerIndex][field] = value;
            }
            renderTable();
        }

        // 記録を削除する関数
        function deleteRecord(playerIndex) {
            records.splice(playerIndex, 1);  // 選手を削除
            renderTable();  // テーブルを再描画
        }

        // 最初にテーブルを描画
        renderTable();
    </script>

</body>
</html>

